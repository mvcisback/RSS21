\documentclass[conference]{IEEEtran}
\usepackage{times}

% numbers option provides compact numerical references in the text. 
\usepackage[numbers]{natbib}
\usepackage{multicol}
\usepackage[bookmarks=true]{hyperref}
%\usepackage[inline]{enumitem}

\pdfinfo{
   /Author (author)
   /Title  (title)
   /CreationDate (D:20101201120000)
   /Subject (Robots)
   /Keywords (Robots)
}

\usepackage{microtype}
\usepackage{amsmath,amssymb}
\usepackage{paralist}
\usepackage{mdframed}
\usepackage{xcolor}
\usepackage{tikz}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{nicefrac}
\usepackage{amsthm}
\usepackage{colonequals}
\newtheorem{theorem}{Theorem}
\newtheorem{proposition}{Proposition}
\theoremstyle{remark}
\newtheorem{remark}{Remark}
\newtheorem{example}{Example}
\newtheorem{definition}{Definition}
\usepackage{import}
\usepackage{pgf}


\usepackage{todonotes}
\usepackage{pgfplots}
\usepackage{algorithm, algorithmicx}
\usepackage[noend]{algpseudocode}

\usepgfplotslibrary{fillbetween}
\usetikzlibrary{patterns,arrows,backgrounds,calc,shapes,shadows,decorations.pathmorphing,decorations.pathreplacing,automata,shapes.multipart,positioning,shapes.geometric,fit,circuits,trees,shapes.gates.logic.US,fit,decorations.markings}

\tikzset{sstate/.style={circle, draw=black, inner sep=1pt,minimum height=6mm}}
\tikzset{astate/.style={diamond, draw=black, inner sep=1pt}}
\tikzset{tstate/.style={rectangle, draw=black, inner sep=1pt, minimum height=5mm}}
\tikzset{actnode/.style={fill=black, inner sep=1pt}}
\tikzset{elab/.style={auto,font={\fontsize{9pt}{12}\selectfont}}}

\tikzset{cross/.style={cross out, draw=black, minimum size=2*(#1-\pgflinewidth), inner sep=0pt, outer sep=0pt},
%default radius will be 1pt. 
cross/.default={1pt}}

\makeatletter
\let\MYcaption\@makecaption
\makeatother

\usepackage[font=footnotesize]{subcaption}

\makeatletter
\let\@makecaption\MYcaption
\makeatother

\newcommand{\Nat}{\mathbb{N}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\mc}{\mathcal{D}}
\newcommand{\sg}{\mathcal{G}}
\renewcommand{\path}{\xi}
\newcommand{\eventually}[1]{\lozenge^{\leq #1}}
\newcommand{\sched}{\sigma}
\newcommand{\Sched}{\Sigma}
\newcommand{\pol}{\sched}
\newcommand{\Distr}{\ensuremath{\textsl{Distr}}}
\newcommand{\act}{\alpha}
\newcommand{\altact}{\beta}
\newcommand{\Act}{A}
\newcommand{\scp}{p}
\newcommand{\scthreshold}{\mathbf{p}}
\newcommand{\scregret}{\epsilon_p}
\newcommand{\target}{s_{\top}} 
\newcommand{\sink}{s_{\bot}}
\newcommand{\rndp}{h}
\newcommand{\randomness}{\mathbf{h}}
\newcommand{\randomnessReget}{\epsilon_h}
\newcommand{\last}[1]{\mathsf{last}({#1})}
\newcommand{\pOneSched}{{\sigma_\pOne}}
\newcommand{\pOneSchedPrime}{{\sigma'_\pOne}}
\newcommand{\pOneSchedPrimePrime}{{\sigma''_\pOne}}
\newcommand{\POneScheds}{\Sigma_\pOne}
\newcommand{\PTwoScheds}{\Sigma_\pTwo}
\newcommand{\pTwoSched}{{\sigma_\pTwo}}
\newcommand{\pTwoSchedWorstH}{{\sigma_\pTwo^H}}
\newcommand{\rat}{\lambda}
\newcommand{\pOne}{\mathsf{ego}}
\newcommand{\pTwo}{\mathsf{env}}
\newcommand{\player}{\mathsf{i}}
\newcommand{\horizon}{\tau}
\newcommand{\solutions}{\mathbb{S}}
\newcommand{\EnAct}{\Act}
\newcommand{\solfuncp}{f_\mathbb{S}}
\newcommand{\scopt}{\scp^{*}}
\newcommand{\rndopt}{\rndp^{*}}
\newcommand{\pareto}[1]{\mathcal{F}_{#1}}
\newcommand{\smoothmax}{\operatorname*{\mathrm{smax}}}
\newcommand{\indicator}[1]{[#1]}
\newcommand{\Succ}{\mathsf{Succ}}

\newcommand{\supp}{\mathsf{support}}
\newcommand{\ppthreshold}{\mathbf{d}}

\newcommand{\scmin}{\scp^{-}}
\newcommand{\rndmin}{\rndp^{-}}
% \newcommand{\pathslbl}{\Xi}
\newcommand{\pathslbl}{\mathsf{Paths}}
\newcommand{\Paths}[2][]{\pathslbl^{#2}_{#1}}
\newcommand{\POnePaths}[2][]{{[\pathslbl^{#2}_{#1}]_\pOne}}
\newcommand{\PTwoPaths}[2][]{{[\pathslbl^{#2}_{#1}]_\pTwo}}
\newcommand{\PlayerPaths}[2][]{{[\pathslbl^{#2}_{#1}]}_{\player}}
\newcommand{\unrolled}[2]{\textsf{Tree}(#1,#2)}
\newcommand{\induced}[2]{#1[#2]}
\newcommand{\causalprob}[2]{\Pr(#1\mid\mid#2)}
\newcommand{\E}{\operatorname*{\mathbb{E}}}
\newcommand{\expOver}[2]{\mathbb{E}_{#1}[#2]}
\newcommand{\soft}{\varphi}
\newcommand{\hard}{\psi}
\newcommand{\rv}[1]{{\mathcal{#1}}}  % Random Variable
\newcommand{\droneEnv}{{D_{\text{new}}}}
\newcommand{\droneEgo}{{D_{\text{test}}}}


\newcommand{\eqdef}{\mathrel{\stackrel{\makebox[0pt]{\mbox{\normalfont\tiny def}}}{=}}}
\newcommand{\mypara}[1]{\noindent{\bf #1.}}
\newcommand{\propref}[1]{{Prop.~\ref{prop:#1}}}
\newcommand{\secref}[1]{{Sec.~\ref{sec:#1}}}

\newcommand{\UPDATE}{{\mathsf{update}}}

\setlength\marginparwidth{110pt}
\newcommand{\colorpar}[3]{\colorbox{#1}{\parbox{#2}{#3}}}
\newcommand{\marginremark}[3]{\marginpar{\colorpar{#2}{\linewidth}{\color{#1}#3}}}
\newcommand{\commentside}[2]{\marginpar{\color{#1}\tiny#2}}
\newcommand{\TODO}[1]{\commentside{teal}{\textsc{Todo:} #1}}
\newcommand{\REMARK}[1]{\commentside{teal}{\textsc{Remark:} #1}}\newcommand{\sj}[1]{\marginremark{black}{red!10!white}{\scriptsize{[SJ]~ #1}}}
\newcommand{\mvc}[1]{\marginremark{black}{gray!10!white}{\scriptsize{[MVC]~ #1}}}

\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}

%\institute{University of California, Berkeley, CA, USA}


\begin{document}

% paper title
\title{Entropy-Guided Control Improvisation}

% You will get a Paper-ID when submitting a pdf file to the conference system
% \author{Author Names Omitted for Anonymous Review. Paper-ID 177}


\author{
  \authorblockN{
    Marcell Vazquez-Chanlatte\authorrefmark{1},
    Sebastian Junges\authorrefmark{1},
    Daniel J. Fremont\authorrefmark{2},
    Sanjit A. Seshia\authorrefmark{1}
  }
  \authorblockA{
    University of California, \{Berkeley\authorrefmark{1}, Santa Cruz\authorrefmark{2}\}
  }
}

% avoiding spaces at the end of the author lines is not a problem with
% conference papers because we don't use \thanks or \IEEEmembership


% for over three affiliations, or if they all won't fit within the width
% of the page, use this alternative format:
% 
%\author{\authorblockN{Michael Shell\authorrefmark{1},
%Homer Simpson\authorrefmark{2},
%James Kirk\authorrefmark{3}, 
%Montgomery Scott\authorrefmark{3} and
%Eldon Tyrell\authorrefmark{4}}
%\authorblockA{\authorrefmark{1}School of Electrical and Computer Engineering\\
%Georgia Institute of Technology,
%Atlanta, Georgia 30332--0250\\ Email: mshell@ece.gatech.edu}
%\authorblockA{\authorrefmark{2}Twentieth Century Fox, Springfield, USA\\
%Email: homer@thesimpsons.com}
%\authorblockA{\authorrefmark{3}Starfleet Academy, San Francisco, California 96678-2391\\
%Telephone: (800) 555--1212, Fax: (888) 555--1212}
%\authorblockA{\authorrefmark{4}Tyrell Inc., 123 Replicant Street, Los Angeles, California 90210--4321}}


\maketitle

\begin{abstract}
  % Sentence 1: State the problem
  High level declarative constraints provide a powerful (and popular)
  way to define and construct control policies; however, most
  synthesis algorithms do not support specifying the degree of
  randomness (unpredictability) of the resulting controller.
  % Sentence 2: State the consequences
  In many contexts, e.g., patrolling, testing, behavior prediction,
  and planning on idealized models, predictable or biased controllers
  are undesirable.
  % Sentence 3: State your solution
  To address these concerns, we introduce the \emph{Entropic Reactive
    Control Improvisation} (ERCI) framework and algorithm which
  support synthesizing control policies for stochastic games that are
  declaratively specified by (i) a \emph{hard constraint} specifying
  what must occur (ii) a \emph{soft constraint} specifying what
  typically occurs, and (iii) a \emph{randomization constraint}
  specifying the unpredictability and variety of the
  controller, as quantified using causal entropy.
  % Sentence 4: State the consequences of the solution
  This framework, which extends the state-of-the-art by supporting
  arbitrary combinations of adversarial and probabilistic uncertainty
  in the environment, enables a flexible modeling formalism which
  we argue, theoretically and empirically, remains tractable.
\end{abstract}

\IEEEpeerreviewmaketitle

%\maketitle\sj{Daniel?}
%\begin{abstract}
%	Efficacious controller synthesis is a key ingredient in the design and analysis of complex systems. We study the design of controllers that have a high entropy, that is, whose behavior or nature is surprising. The synthesis of such controllers is key in domains like testing and security. 
%	In particular, our paper studies control improvisation and compares them with randomly sampling adequate policies. The only difference in obtained policies is in their notion of entropy, but the problems are significantly different.  We illustrate and contrast their merits and limitations. Furthermore, we provide algorithms that solve both control improvisation problems. Prominently, we solve the control improvisation problem for Markov decision processes by relating it to recent results from inference from demonstrations, and then extend this approach to stochastic games. We present a prototypical implementation that efficiently solves controller synthesis problems from the security and testing domain. 
%\end{abstract}
\section{Introduction}
\input{introduction}
\section{Motivating Example}
\label{sec:motivating}

\input{example}
\section{Problem Statement}
\label{sec:problem}
This section formalizes the novel Entropic Reactive Control Improvisation (ERCI).  We start with some necessary definitions and notations on stochastic games.


\input{problem}

\input{aspects}


\input{mdp}
 
\section{The Control Improvisation Problem for SGs}\label{sec:sgs}
\input{sg}
%\begin{mdframed}
%
%\begin{compactenum}
%	\item $\Pr^\sg_{\langle \sched_1,\sched_2 \rangle}(\eventually{h} T) \geq 1$
%	\item $\Pr^\sg_{\langle \sched_1,\sched_2 \rangle}(\eventually{h} G) \geq \lambda$ 
%\end{compactenum}
%\end{mdframed}
%\sj{Define randomly selected policy}
%\sj{Describe in terms of pMDPp}


\section{Implementation and Empirical Evaluation}
\label{sec:empirical}
\input{experiment.tex}

\input{related}
\input{conclusion}

{\vspace{0.5em} 
  \noindent\textbf{Acknowledgments}:
This work is partially supported by NSF grants 1545126 (VeHICaL), 1646208 and 1837132, by the DARPA contracts FA8750-18-C-0101 (Assured Autonomy) and FA8750-20-C-0156 (SDCPS), by Berkeley Deep Drive, and by Toyota under the iCyPhy center.}


\bibliographystyle{plainnat}
\bibliography{bibliography}


\input{proofs}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:

